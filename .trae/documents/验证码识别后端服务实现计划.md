# 验证码识别后端服务实现计划

## 项目概述

创建一个HTTP后端服务，接收base64编码的验证码图片，识别其中的数字和四则运算符号，计算并返回结果值（整数）。

## 技术选型

* **运行环境**：Node.js 18+

* **Web框架**：Express.js

* **OCR引擎**：Tesseract.js（用于文本识别）

* **图像处理**：Jimp（用于图像预处理）

* **依赖管理**：npm

## 项目结构

```
captcha-reader/
├── src/
│   ├── app.js           # 主应用入口
│   ├── routes/
│   │   └── captcha.js   # 验证码识别路由
│   ├── services/
│   │   └── captchaService.js  # 验证码处理服务
│   └── utils/
│       └── imageUtils.js  # 图像处理工具
├── package.json         # 项目配置和依赖
└── README.md            # 项目说明
```

## 核心功能实现

### 1. API接口

* **端点**：`POST /api/captcha/recognize`

* **请求体**：`{ "image": "base64编码的图片字符串" }`

* **响应**：`{ "result": 计算结果整数 }` 或错误信息

### 2. 图像处理流程

1. 解码base64字符串为Buffer
2. 转换为图像并进行预处理（灰度化、二值化、降噪）
3. 使用Tesseract.js识别文本
4. 提取数字和运算符号
5. 解析算术表达式
6. 计算结果并返回

### 3. 表达式处理

* 支持的运算符：`+`、`-`、`*`、`/`

* 处理优先级：先乘除后加减

* 结果取整：使用整数除法

### 4. 错误处理

* 图像解码错误

* OCR识别失败

* 表达式解析错误

* 计算错误

## 依赖安装

```bash
npm init -y
npm install express tesseract.js jimp body-parser
```

## 启动服务

```bash
node src/app.js
```

## 测试方法

使用Postman或curl发送POST请求到 `http://localhost:3000/api/captcha/recognize`
